import chess

def is_middle_game(board: chess.Board) -> bool:
    # Count the major and minor pieces remaining
    piece_count = 0
    for piece_type in [chess.ROOK, chess.QUEEN, chess.BISHOP, chess.KNIGHT]:
        piece_count += len(board.pieces(piece_type, chess.WHITE)) + len(
            board.pieces(piece_type, chess.BLACK)
        )

    # Middle game is roughly when both sides have 5 or more major and minor pieces
    return piece_count > 10


piece_values = {
    chess.PAWN: 1,
    chess.KNIGHT: 3,
    chess.BISHOP: 3,
    chess.ROOK: 5,
    chess.QUEEN: 9,
    chess.KING: 0,
}

king_table_midgame = [
    -3.0,
    -4.0,
    -4.0,
    -5.0,
    -5.0,
    -4.0,
    -4.0,
    -3.0,
    -3.0,
    -4.0,
    -4.0,
    -5.0,
    -5.0,
    -4.0,
    -4.0,
    -3.0,
    -3.0,
    -4.0,
    -4.0,
    -5.0,
    -5.0,
    -4.0,
    -4.0,
    -3.0,
    -3.0,
    -4.0,
    -4.0,
    -5.0,
    -5.0,
    -4.0,
    -4.0,
    -3.0,
    -2.0,
    -3.0,
    -3.0,
    -4.0,
    -4.0,
    -3.0,
    -3.0,
    -2.0,
    -1.0,
    -2.0,
    -2.0,
    -2.0,
    -2.0,
    -2.0,
    -2.0,
    -1.0,
    2.0,
    2.0,
    0.0,
    0.0,
    0.0,
    0.0,
    2.0,
    2.0,
    2.0,
    3.0,
    1.0,
    0.0,
    0.0,
    1.0,
    3.0,
    2.0,
]

king_table_endgame = [
    -5.0,
    -4.0,
    -3.0,
    -2.0,
    -2.0,
    -3.0,
    -4.0,
    -5.0,
    -3.0,
    -2.0,
    -1.0,
    0.0,
    0.0,
    -1.0,
    -2.0,
    -3.0,
    -3.0,
    -1.0,
    2.0,
    3.0,
    3.0,
    2.0,
    -1.0,
    -3.0,
    -3.0,
    -1.0,
    3.0,
    4.0,
    4.0,
    3.0,
    -1.0,
    -3.0,
    -3.0,
    -1.0,
    3.0,
    4.0,
    4.0,
    3.0,
    -1.0,
    -3.0,
    -3.0,
    -1.0,
    2.0,
    3.0,
    3.0,
    2.0,
    -1.0,
    -3.0,
    -3.0,
    -3.0,
    0.0,
    0.0,
    0.0,
    0.0,
    -3.0,
    -3.0,
    -5.0,
    -3.0,
    -3.0,
    -3.0,
    -3.0,
    -3.0,
    -3.0,
    -5.0,
]


def get_position_table(board: chess.Board) -> dict[list[float]]:
    position_tables = {
        chess.PAWN: [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            5.0,
            5.0,
            5.0,
            5.0,
            5.0,
            5.0,
            5.0,
            5.0,
            1.0,
            1.0,
            2.0,
            3.0,
            3.0,
            2.0,
            1.0,
            1.0,
            0.5,
            0.5,
            1.0,
            2.5,
            2.5,
            1.0,
            0.5,
            0.5,
            0.0,
            0.0,
            0.0,
            2.0,
            2.0,
            0.0,
            0.0,
            0.0,
            0.5,
            -0.5,
            -1.0,
            0.0,
            0.0,
            -1.0,
            -0.5,
            0.5,
            0.5,
            1.0,
            1.0,
            -2.0,
            -2.0,
            1.0,
            1.0,
            0.5,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
        ],
        chess.KNIGHT: [
            -5.0,
            -4.0,
            -3.0,
            -3.0,
            -3.0,
            -3.0,
            -4.0,
            -5.0,
            -4.0,
            -2.0,
            0.0,
            0.5,
            0.5,
            0.0,
            -2.0,
            -4.0,
            -3.0,
            0.5,
            1.0,
            1.5,
            1.5,
            1.0,
            0.5,
            -3.0,
            -3.0,
            0.0,
            1.5,
            2.0,
            2.0,
            1.5,
            0.0,
            -3.0,
            -3.0,
            0.5,
            1.5,
            2.0,
            2.0,
            1.5,
            0.5,
            -3.0,
            -3.0,
            0.0,
            1.0,
            1.5,
            1.5,
            1.0,
            0.0,
            -3.0,
            -4.0,
            -2.0,
            0.0,
            0.5,
            0.5,
            0.0,
            -2.0,
            -4.0,
            -5.0,
            -4.0,
            -3.0,
            -3.0,
            -3.0,
            -3.0,
            -4.0,
            -5.0,
        ],
        chess.BISHOP: [
            -2.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -2.0,
            -1.0,
            0.0,
            0.0,
            0.5,
            0.5,
            0.0,
            0.0,
            -1.0,
            -1.0,
            0.0,
            0.5,
            1.0,
            1.0,
            0.5,
            0.0,
            -1.0,
            -1.0,
            0.5,
            0.5,
            1.0,
            1.0,
            0.5,
            0.5,
            -1.0,
            -1.0,
            0.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.0,
            -1.0,
            -1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            -1.0,
            -1.0,
            0.5,
            0.0,
            0.0,
            0.0,
            0.0,
            0.5,
            -1.0,
            -2.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -2.0,
        ],
        chess.ROOK: [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.5,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.5,
            -0.5,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            -0.5,
            -0.5,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            -0.5,
            -0.5,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            -0.5,
            -0.5,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            -0.5,
            -0.5,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            -0.5,
            0.0,
            0.0,
            0.0,
            0.5,
            0.5,
            0.0,
            0.0,
            0.0,
        ],
        chess.QUEEN: [
            -2.0,
            -1.0,
            -1.0,
            -0.5,
            -0.5,
            -1.0,
            -1.0,
            -2.0,
            -1.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            -1.0,
            -1.0,
            0.0,
            0.5,
            0.5,
            0.5,
            0.5,
            0.0,
            -1.0,
            -0.5,
            0.0,
            0.5,
            0.5,
            0.5,
            0.5,
            0.0,
            -0.5,
            0.0,
            0.0,
            0.5,
            0.5,
            0.5,
            0.5,
            0.0,
            -0.5,
            -1.0,
            0.5,
            0.5,
            0.5,
            0.5,
            0.5,
            0.0,
            -1.0,
            -1.0,
            0.0,
            0.5,
            0.0,
            0.0,
            0.0,
            0.0,
            -1.0,
            -2.0,
            -1.0,
            -1.0,
            -0.5,
            -0.5,
            -1.0,
            -1.0,
            -2.0,
        ],
        chess.KING: king_table_midgame if is_middle_game(board) else king_table_endgame,
    }
    return position_tables
